function getCookie(t){const e=`; ${document.cookie}`.split(`; ${t}=`)
if(2===e.length)return e.pop().split(";").shift()}function initAjaxForm(t,e,o){const n=document.querySelector(t)
n&&n.addEventListener("submit",(async function(t){t.preventDefault()
const i=new FormData(n),a=getCookie("X-XSRF-TOKEN")
try{const s=await fetch(n.action,{method:"POST",headers:{...a?{"X-XSRF-TOKEN":a}:{}},body:i})
if(s.ok)window.location.href="/"
else{let n=o
try{const t=await s.text()
try{const e=JSON.parse(t)
e.message?n=e.message:e.error&&e.status?n=e.message||e.error:e.error?n=e.error:"string"==typeof e&&(n=e),"Bad credentials"===n&&(n="Неверное имя пользователя или пароль")}catch(e){n=t||o}}catch(t){}showNotification(e,n)}}catch(t){showNotification(e,"Ошибка сети или сервера")}}))}function showNotification(t,e){let o=document.getElementById(t)
o||(o=document.createElement("div"),o.id=t,o.className="alert alert-danger position-fixed top-0 start-50 translate-middle-x mt-3",o.style.zIndex=9999,document.body.appendChild(o)),o.textContent=e,o.classList.remove("d-none"),setTimeout((()=>{o.classList.add("d-none")}),4e3)}window.initAjaxForm=initAjaxForm
